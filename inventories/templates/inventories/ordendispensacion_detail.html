{% extends 'base.html' %}

{% block title %}Detalle de Orden de Dispensación{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="card shadow-sm">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h3>Orden de Dispensación #{{ orden.pk }}</h3>
            <div>
                <a href="{% url 'admision_recepcion:orden_update' orden.pk %}" class="btn btn-primary">Editar Orden</a>
                <a href="{% url 'admision_recepcion:orden_delete' orden.pk %}" class="btn btn-danger">Eliminar Orden</a>
            </div>
        </div>
        <div class="card-body">
            <p><strong>Paciente:</strong> <a href="{% url 'patients:paciente_detail' orden.paciente.pk %}">{{ orden.paciente.nombres }} {{ orden.paciente.apellidos }}</a></p>
            <p><strong>Fecha de Dispensación:</strong> {{ orden.fecha_dispensacion|date:"d M, Y H:i" }}</p>
            <p><strong>Observaciones:</strong> {{ orden.observaciones|default:"Sin observaciones." }}</p>
        </div>
    </div>

    <div class="card mt-4">
        <div class="card-header">
            <h4>Productos Dispensados</h4>
        </div>
        <div class="card-body">
            {% if orden.detalleordendispensacion_set.all %}
            <ul class="list-group">
                {% for detalle in orden.detalleordendispensacion_set.all %}
                    <li class="list-group-item">
                        <strong>{{ detalle.producto.nombre }}</strong>: {{ detalle.cantidad|floatformat:2 }} {{ detalle.producto.unidad_medida }}
                    </li>
                {% endfor %}
            </ul>
            {% else %}
                <p>No hay productos registrados en esta orden de dispensación.</p>
            {% endif %}
        </div>
    </div>
    
    <div class="mt-4">
        <a href="{% url 'admision_recepcion:orden_list' %}" class="btn btn-secondary">Volver a las Órdenes de Dispensación</a>
    </div>
</div>
{% endblock %} 